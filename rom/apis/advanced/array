-- Array - Multi-Dimensional Array Indexed by Key Sequences

-- Purpose:
--   Provide multi-dimensional arrays.
--   The key must be a sequence.

local table = loader.requireApi("table")
local object = loader.requireApi("object")

local class, inst = object:createSubclass("array")
loader.installAsApi(class)


local function makeKey(index)
  return table.concat(index, "\0")
end


function inst:set(index, value)
  self[makeKey(index)] = value
end

function inst:get(index)
  return self[makeKey(index)]
end


local test = lunit.new(class)

function test.twodim()
  local a = class:new()
  for i=-1,2 do
    for j=-2,1 do
      a:set({i, j}, i*10+j)
    end
  end
  for i=-1,2 do
    for j=-2,1 do
      lunit.areEqual(i*10+j, a:get({i, j}))
    end
  end
end
